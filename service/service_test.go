package service

import (
	"encoding/json"
	"flight-cache-lifecycle-manager/models"
	"fmt"
	redisV8 "github.com/go-redis/redis/v8"
	"github.com/magiconair/properties"
	"github.com/magiconair/properties/assert"
	"github.com/opensearch-project/opensearch-go"
	"log"
	"math"
	"os"
	"path/filepath"
	"strconv"
	"testing"
	"time"
)

type MockOpenSearchClient struct {
}

func (osMock MockOpenSearchClient) DeleteEntry(cacheEntryKeys []string, client *opensearch.Client) (int, error) {

	return 200, nil
}

func (osMock MockOpenSearchClient) GetResponseFromOS(*opensearch.Client) (*models.OpenSearchResponse, error) {

	var k = make(map[string]time.Time)
	y := time.Now()
	k["AMS-NYC-EK-NDC-2022-06-04-O"] = y.AddDate(0, -3, -3)
	k["AMS-NYC-EK-NDC-2022-06-03-O"] = y.AddDate(0, -3, -2)
	k["AMS-NYC-AF-OTH-2022-06-02-O"] = y.AddDate(0, -3, -3)
	k["AMS-NYC"] = y.AddDate(0, -3, -3)
	k["AMS-NYC-AF-OTH-2022-06-04-O"] = y.AddDate(0, 3, 3)

	var openSearchResponse *models.OpenSearchResponse
	str := "{\n  \"took\" : 1,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"skipped\" : 0,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : {\n      \"value\" : 1,\n      \"relation\" : \"eq\"\n    },\n    \"max_score\" : 1.0,\n    \"hits\" : [\n      {\n        \"_index\" : \"test-flight-offers\",\n        \"_type\" : \"_doc\",\n        \"_id\" : \"AMS-NYC-EK-NDC-2022-04-02-O\",\n        \"_score\" : 1.0,\n        \"_source\" : {\n          \"routes\" : {\n            \"PJ17\" : {\n              \"elapsedFlyingTimeMinutes\" : 665,\n              \"id\" : \"PJ17\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG25\",\n                \"SEG26\"\n              ]\n            },\n            \"PJ1\" : {\n              \"elapsedFlyingTimeMinutes\" : 480,\n              \"id\" : \"PJ1\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG1\"\n              ]\n            },\n            \"PJ14\" : {\n              \"elapsedFlyingTimeMinutes\" : 695,\n              \"id\" : \"PJ14\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG20\",\n                \"SEG21\"\n              ]\n            },\n            \"PJ3\" : {\n              \"elapsedFlyingTimeMinutes\" : 484,\n              \"id\" : \"PJ3\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG3\"\n              ]\n            },\n            \"PJ13\" : {\n              \"elapsedFlyingTimeMinutes\" : 660,\n              \"id\" : \"PJ13\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG18\",\n                \"SEG19\"\n              ]\n            },\n            \"PJ2\" : {\n              \"elapsedFlyingTimeMinutes\" : 480,\n              \"id\" : \"PJ2\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG2\"\n              ]\n            },\n            \"PJ16\" : {\n              \"elapsedFlyingTimeMinutes\" : 715,\n              \"id\" : \"PJ16\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG22\",\n                \"SEG24\"\n              ]\n            },\n            \"PJ5\" : {\n              \"elapsedFlyingTimeMinutes\" : 484,\n              \"id\" : \"PJ5\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG5\"\n              ]\n            },\n            \"PJ15\" : {\n              \"elapsedFlyingTimeMinutes\" : 715,\n              \"id\" : \"PJ15\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG22\",\n                \"SEG23\"\n              ]\n            },\n            \"PJ4\" : {\n              \"elapsedFlyingTimeMinutes\" : 484,\n              \"id\" : \"PJ4\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG4\"\n              ]\n            },\n            \"PJ10\" : {\n              \"elapsedFlyingTimeMinutes\" : 695,\n              \"id\" : \"PJ10\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG12\",\n                \"SEG13\"\n              ]\n            },\n            \"PJ7\" : {\n              \"elapsedFlyingTimeMinutes\" : 501,\n              \"id\" : \"PJ7\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG7\"\n              ]\n            },\n            \"PJ6\" : {\n              \"elapsedFlyingTimeMinutes\" : 485,\n              \"id\" : \"PJ6\",\n              \"stops\" : 0,\n              \"segmentIDs\" : [\n                \"SEG6\"\n              ]\n            },\n            \"PJ12\" : {\n              \"elapsedFlyingTimeMinutes\" : 710,\n              \"id\" : \"PJ12\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG16\",\n                \"SEG17\"\n              ]\n            },\n            \"PJ9\" : {\n              \"elapsedFlyingTimeMinutes\" : 680,\n              \"id\" : \"PJ9\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG10\",\n                \"SEG11\"\n              ]\n            },\n            \"PJ11\" : {\n              \"elapsedFlyingTimeMinutes\" : 710,\n              \"id\" : \"PJ11\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG14\",\n                \"SEG15\"\n              ]\n            },\n            \"PJ8\" : {\n              \"elapsedFlyingTimeMinutes\" : 694,\n              \"id\" : \"PJ8\",\n              \"stops\" : 1,\n              \"segmentIDs\" : [\n                \"SEG8\",\n                \"SEG9\"\n              ]\n            }\n          },\n          \"ancillaries\" : [\n            {\n              \"additionalParams\" : {\n                \"pieces\" : \"1\",\n                \"type\" : \"NORMAL\"\n              },\n              \"id\" : \"BA1_BAGGAGE\",\n              \"type\" : \"BAGGAGE\"\n            },\n            {\n              \"additionalParams\" : {\n                \"pieces\" : \"1\",\n                \"type\" : \"HAND\"\n              },\n              \"id\" : \"HAND\",\n              \"type\" : \"BAGGAGE\"\n            }\n          ],\n          \"combinations\" : [\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"c859097b-3836-44ea-9909-7b383634eab3\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0001\",\n                \"c859097b-3836-44ea-9909-7b383634eab3\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ1\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG1\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"c587aa2b-2b02-4162-87aa-2b2b02f162cb\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0002\",\n                \"c587aa2b-2b02-4162-87aa-2b2b02f162cb\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ2\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG2\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"a464aa9c-0c60-4c86-a4aa-9c0c603c86e4\",\n                \"a464aa9c-0c60-4c86-a4aa-9c0c603c86e4\" : \"PAX1\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0003\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ3\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG3\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"ed7cd1d8-c7ff-4c3d-bcd1-d8c7fffc3d2b\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"ed7cd1d8-c7ff-4c3d-bcd1-d8c7fffc3d2b\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0004\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ4\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG4\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"d24b09eb-8b01-4fd5-8b09-eb8b01cfd5a0\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0005\",\n                \"d24b09eb-8b01-4fd5-8b09-eb8b01cfd5a0\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ5\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG5\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"ced59873-026f-4425-9598-73026fb4254b\",\n                \"ced59873-026f-4425-9598-73026fb4254b\" : \"PAX1\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0006\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ6\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG6\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1983.42,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"b6afe7ba-03c3-428d-afe7-ba03c3a28d37\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"b6afe7ba-03c3-428d-afe7-ba03c3a28d37\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0007\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 187.42,\n              \"routeIDs\" : [\n                \"PJ7\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG7\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 187.42,\n                  \"fareAmount\" : 1983.42\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1988.14,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"c986bd0d-2732-4b76-86bd-0d2732ab7687\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"c986bd0d-2732-4b76-86bd-0d2732ab7687\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0008\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 192.14,\n              \"routeIDs\" : [\n                \"PJ8\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG8\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG9\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 192.14,\n                  \"fareAmount\" : 1988.14\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1988.95,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"d6cef17b-6804-40b6-8ef1-7b6804c0b61f\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0009\",\n                \"d6cef17b-6804-40b6-8ef1-7b6804c0b61f\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 192.95,\n              \"routeIDs\" : [\n                \"PJ9\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG10\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG11\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 192.95,\n                  \"fareAmount\" : 1988.95\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1988.95,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"ce31d6bb-ac49-4a8f-b1d6-bbac498a8f69\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000a\",\n                \"ce31d6bb-ac49-4a8f-b1d6-bbac498a8f69\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 192.95,\n              \"routeIDs\" : [\n                \"PJ10\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG12\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG13\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 192.95,\n                  \"fareAmount\" : 1988.95\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1988.95,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"c6000399-8eb4-4f3e-8003-998eb40f3e34\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"c6000399-8eb4-4f3e-8003-998eb40f3e34\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000b\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 192.95,\n              \"routeIDs\" : [\n                \"PJ11\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG14\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG15\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 192.95,\n                  \"fareAmount\" : 1988.95\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 1988.95,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"e54f27ca-b5e2-4bf7-8f27-cab5e20bf713\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000c\",\n                \"e54f27ca-b5e2-4bf7-8f27-cab5e20bf713\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 192.95,\n              \"routeIDs\" : [\n                \"PJ12\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG16\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG17\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 192.95,\n                  \"fareAmount\" : 1988.95\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 2009.56,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"a1f1bb8b-806c-417a-b1bb-8b806ca17ab2\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"a1f1bb8b-806c-417a-b1bb-8b806ca17ab2\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000d\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 213.56,\n              \"routeIDs\" : [\n                \"PJ13\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG18\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG19\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 213.56,\n                  \"fareAmount\" : 2009.56\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 2009.56,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"e1ed8d19-db42-4ce3-ad8d-19db42fce38b\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000e\",\n                \"e1ed8d19-db42-4ce3-ad8d-19db42fce38b\" : \"PAX1\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 213.56,\n              \"routeIDs\" : [\n                \"PJ14\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG20\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG21\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 213.56,\n                  \"fareAmount\" : 2009.56\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 2009.56,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"d9e3aba6-2e91-48c0-a3ab-a62e9128c01b\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"d9e3aba6-2e91-48c0-a3ab-a62e9128c01b\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d000f\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 213.56,\n              \"routeIDs\" : [\n                \"PJ15\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG22\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG23\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 213.56,\n                  \"fareAmount\" : 2009.56\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 2009.56,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"e6815576-f5d4-479b-8155-76f5d4c79b28\",\n                \"e6815576-f5d4-479b-8155-76f5d4c79b28\" : \"PAX1\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0010\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 213.56,\n              \"routeIDs\" : [\n                \"PJ16\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG22\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG24\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 213.56,\n                  \"fareAmount\" : 2009.56\n                }\n              ]\n            },\n            {\n              \"tariffType\" : \"PU\",\n              \"totalFareAmount\" : 2015.2,\n              \"additionalParams\" : {\n                \"offerItemIds\" : \"b85c97d2-10c6-401f-9c97-d210c6601f66\",\n                \"offerValidity\" : \"2021-08-05T09:45:35.619Z\",\n                \"b85c97d2-10c6-401f-9c97-d210c6601f66\" : \"PAX1\",\n                \"offerId\" : \"c6620ec8-6af0-4def-a20e-c86af03d0011\",\n                \"IsValid\" : \"false\"\n              },\n              \"totalTaxAmount\" : 219.2,\n              \"routeIDs\" : [\n                \"PJ17\"\n              ],\n              \"fares\" : [\n                {\n                  \"paxType\" : \"ADT\",\n                  \"vcc\" : \"KL\",\n                  \"paxId\" : \"adt1\",\n                  \"fareProducts\" : [\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG25\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    },\n                    {\n                      \"ancillaryIDs\" : [\n                        \"BA1_BAGGAGE\",\n                        \"HAND\"\n                      ],\n                      \"fareBase\" : \"BS00BENB\",\n                      \"segmentID\" : \"SEG26\",\n                      \"cabinProduct\" : \"ECONOMY\"\n                    }\n                  ],\n                  \"taxAmount\" : 219.2,\n                  \"fareAmount\" : 2015.2\n                }\n              ]\n            }\n          ],\n          \"additionalParams\" : {\n            \"correlationId\" : \"NDC-TFM-SONATA20210805091532118099\"\n          },\n          \"segments\" : {\n            \"SEG20\" : {\n              \"departureTime\" : \"2021-10-21T15:55:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T16:15:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"LHR\",\n              \"destinationTerminal\" : \"2\",\n              \"id\" : \"SEG20\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1021\"\n            },\n            \"SEG9\" : {\n              \"departureTime\" : \"2021-10-21T14:25:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"E75\",\n              \"arrivalTime\" : \"2021-10-21T15:54:00\",\n              \"origin\" : \"BOS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG9\",\n              \"operatingCarrier\" : \"YX\",\n              \"originTerminal\" : \"A\",\n              \"flightNumber\" : \"5103\"\n            },\n            \"SEG23\" : {\n              \"departureTime\" : \"2021-10-21T13:30:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"789\",\n              \"arrivalTime\" : \"2021-10-21T16:10:00\",\n              \"origin\" : \"LHR\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG23\",\n              \"operatingCarrier\" : \"VS\",\n              \"originTerminal\" : \"3\",\n              \"flightNumber\" : \"2502\"\n            },\n            \"SEG7\" : {\n              \"departureTime\" : \"2021-10-21T10:35:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"339\",\n              \"arrivalTime\" : \"2021-10-21T12:56:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG7\",\n              \"operatingCarrier\" : \"DL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"6020\"\n            },\n            \"SEG24\" : {\n              \"departureTime\" : \"2021-10-21T13:30:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"789\",\n              \"arrivalTime\" : \"2021-10-21T16:10:00\",\n              \"origin\" : \"LHR\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG24\",\n              \"operatingCarrier\" : \"VS\",\n              \"originTerminal\" : \"3\",\n              \"flightNumber\" : \"2503\"\n            },\n            \"SEG8\" : {\n              \"departureTime\" : \"2021-10-21T10:20:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"781\",\n              \"arrivalTime\" : \"2021-10-21T12:10:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"BOS\",\n              \"destinationTerminal\" : \"\",\n              \"id\" : \"SEG8\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0073\"\n            },\n            \"SEG21\" : {\n              \"departureTime\" : \"2021-10-21T18:50:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"351\",\n              \"arrivalTime\" : \"2021-10-21T21:30:00\",\n              \"origin\" : \"LHR\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG21\",\n              \"operatingCarrier\" : \"VS\",\n              \"originTerminal\" : \"3\",\n              \"flightNumber\" : \"4824\"\n            },\n            \"SEG5\" : {\n              \"departureTime\" : \"2021-10-21T17:55:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"781\",\n              \"arrivalTime\" : \"2021-10-21T19:59:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG5\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0075\"\n            },\n            \"SEG22\" : {\n              \"departureTime\" : \"2021-10-21T10:15:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T10:45:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"LHR\",\n              \"destinationTerminal\" : \"2\",\n              \"id\" : \"SEG22\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1009\"\n            },\n            \"SEG6\" : {\n              \"departureTime\" : \"2021-10-21T13:20:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"332\",\n              \"arrivalTime\" : \"2021-10-21T15:25:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG6\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0641\"\n            },\n            \"SEG25\" : {\n              \"departureTime\" : \"2021-10-21T08:25:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"E75\",\n              \"arrivalTime\" : \"2021-10-21T09:35:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"FRA\",\n              \"destinationTerminal\" : \"2\",\n              \"id\" : \"SEG25\",\n              \"operatingCarrier\" : \"WA\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1763\"\n            },\n            \"SEG26\" : {\n              \"departureTime\" : \"2021-10-21T10:45:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"764\",\n              \"arrivalTime\" : \"2021-10-21T13:30:00\",\n              \"origin\" : \"FRA\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG26\",\n              \"operatingCarrier\" : \"DL\",\n              \"originTerminal\" : \"2\",\n              \"flightNumber\" : \"6107\"\n            },\n            \"SEG12\" : {\n              \"departureTime\" : \"2021-10-21T07:15:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T08:40:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"CDG\",\n              \"destinationTerminal\" : \"2F\",\n              \"id\" : \"SEG12\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1227\"\n            },\n            \"SEG13\" : {\n              \"departureTime\" : \"2021-10-21T10:20:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"333\",\n              \"arrivalTime\" : \"2021-10-21T12:50:00\",\n              \"origin\" : \"CDG\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG13\",\n              \"operatingCarrier\" : \"DL\",\n              \"originTerminal\" : \"2E\",\n              \"flightNumber\" : \"6184\"\n            },\n            \"SEG10\" : {\n              \"departureTime\" : \"2021-10-21T16:30:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T17:45:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"CDG\",\n              \"destinationTerminal\" : \"2F\",\n              \"id\" : \"SEG10\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1243\"\n            },\n            \"SEG11\" : {\n              \"departureTime\" : \"2021-10-21T19:20:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"772\",\n              \"arrivalTime\" : \"2021-10-21T21:50:00\",\n              \"origin\" : \"CDG\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"1\",\n              \"id\" : \"SEG11\",\n              \"operatingCarrier\" : \"AF\",\n              \"originTerminal\" : \"2E\",\n              \"flightNumber\" : \"2307\"\n            },\n            \"SEG16\" : {\n              \"departureTime\" : \"2021-10-21T12:25:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T13:40:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"CDG\",\n              \"destinationTerminal\" : \"2F\",\n              \"id\" : \"SEG16\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1233\"\n            },\n            \"SEG17\" : {\n              \"departureTime\" : \"2021-10-21T15:45:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"77W\",\n              \"arrivalTime\" : \"2021-10-21T18:15:00\",\n              \"origin\" : \"CDG\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"1\",\n              \"id\" : \"SEG17\",\n              \"operatingCarrier\" : \"AF\",\n              \"originTerminal\" : \"2E\",\n              \"flightNumber\" : \"2304\"\n            },\n            \"SEG14\" : {\n              \"departureTime\" : \"2021-10-21T08:00:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T09:25:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"CDG\",\n              \"destinationTerminal\" : \"2F\",\n              \"id\" : \"SEG14\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1229\"\n            },\n            \"SEG15\" : {\n              \"departureTime\" : \"2021-10-21T11:20:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"77W\",\n              \"arrivalTime\" : \"2021-10-21T13:50:00\",\n              \"origin\" : \"CDG\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"1\",\n              \"id\" : \"SEG15\",\n              \"operatingCarrier\" : \"AF\",\n              \"originTerminal\" : \"2E\",\n              \"flightNumber\" : \"2425\"\n            },\n            \"SEG18\" : {\n              \"departureTime\" : \"2021-10-21T08:40:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"73H\",\n              \"arrivalTime\" : \"2021-10-21T09:00:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"LHR\",\n              \"destinationTerminal\" : \"2\",\n              \"id\" : \"SEG18\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"1007\"\n            },\n            \"SEG19\" : {\n              \"departureTime\" : \"2021-10-21T11:00:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"351\",\n              \"arrivalTime\" : \"2021-10-21T13:40:00\",\n              \"origin\" : \"LHR\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG19\",\n              \"operatingCarrier\" : \"VS\",\n              \"originTerminal\" : \"3\",\n              \"flightNumber\" : \"4820\"\n            },\n            \"SEG3\" : {\n              \"departureTime\" : \"2021-10-21T17:55:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"772\",\n              \"arrivalTime\" : \"2021-10-21T19:59:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG3\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0063\"\n            },\n            \"SEG4\" : {\n              \"departureTime\" : \"2021-10-21T17:55:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"789\",\n              \"arrivalTime\" : \"2021-10-21T19:59:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG4\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0643\"\n            },\n            \"SEG1\" : {\n              \"departureTime\" : \"2021-10-21T13:25:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"781\",\n              \"arrivalTime\" : \"2021-10-21T15:25:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG1\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0154\"\n            },\n            \"SEG2\" : {\n              \"departureTime\" : \"2021-10-21T13:25:00\",\n              \"marketingCarrier\" : \"KL\",\n              \"airplaneType\" : \"789\",\n              \"arrivalTime\" : \"2021-10-21T15:25:00\",\n              \"origin\" : \"AMS\",\n              \"destination\" : \"JFK\",\n              \"destinationTerminal\" : \"4\",\n              \"id\" : \"SEG2\",\n              \"operatingCarrier\" : \"KL\",\n              \"originTerminal\" : \"\",\n              \"flightNumber\" : \"0071\"\n            }\n          },\n          \"timestamp\" : \"2022-03-24T04:44:02.362291Z\"\n        }\n      }\n    ]\n  }\n}\n"
	_ = json.Unmarshal([]byte(str), &openSearchResponse)
	return openSearchResponse, nil
}

func (osMock MockOpenSearchClient) UpdateValidityBasedOnOfferValidity(client *opensearch.Client, id string, body string) int {
	log.Println("in mock to Update Validity Based On Offer Validity")
	return 200
}

type MockRedisClient struct {
}

func (mCache MockRedisClient) LifeCycleManager(keysToBeDeleted []string, client *redisV8.Client) string {
	return "Mock redis client"
}

func (mCache MockRedisClient) Query(CacheEntryKey string, client *redisV8.Client) (*models.CacheEntry, error) {
	return &models.CacheEntry{
		Key:   "",
		Value: "",
	}, nil
}

func (mCache MockRedisClient) AddEntry(CacheEntry *models.CacheEntry, client *redisV8.Client, ttlInMinutes int) error {
	return nil
}

func (mCache MockRedisClient) GetAllKeys(client *redisV8.Client) []string {
	keys := []string{"AMS-NYC-EK-NDC-2022-01-04-O", "AMS-NYC-EK-NDC-2022-02-04-O", "AMS-NYC", "AMS-NYC-EK-NDC-2022-06-04-O"}
	return keys
}

func loadProperties() *properties.Properties {
	myDir, err := os.Getwd()
	if err != nil {
		log.Println(err)
	}
	log.Println(myDir)

	propFile, err := filepath.Abs("../resources/service.properties")
	if err != nil {
		log.Panicln("PropFile file not found at ", propFile, " error: ", err.Error())
	}

	propertiesInstance := properties.MustLoadFile(propFile, properties.UTF8)

	return propertiesInstance
}

func Test_ManageEntriesCache(t *testing.T) {
	//cacheClientType := MockRedisClient{}
	//cacheManagerService := CacheManagerImpl{
	//	Client:     nil,
	//	ClientType: cacheClientType,
	//}
	//b, err := cacheManagerService.ManageEntries(nil,nil,nil)
	//
	//assert.Equal(t, 3, len(b))
	//assert.Equal(t, nil, err)

}

func Test_ManageEntries(t *testing.T) {

	//prop := loadProperties()
	//
	//dbClientType := MockOpenSearchClient{}
	//dbMangerService := DbManagerImpl{
	//	OSClient:     nil,
	//	OSClientType: dbClientType,
	//}
	//
	////execute
	//keysDeleted, err := dbMangerService.ManageEntries(prop)
	//log.Println("keys to be deleted:", keysDeleted)
	////validations
	//assert.Equal(t, len(keysDeleted), 2)
	//assert.Equal(t, err, nil)
}

func Test_deletionBasedOnDepDate(t *testing.T) {

	keys := []string{"AMS-NYC-EK-NDC-2022-06-04-O", "AMS-NYC-EK-NDC-2022-06-03-O", "AMS-NYC-EK-NDC-2022-06-02-O"}
	k, _ := deletionBasedOnDepDate(keys)

	assert.Equal(t, 0, len(k))

}

func Test_deletionBasedOnDepDateWithError(t *testing.T) {

	keys := []string{"AMS-NYC"}
	k, _ := deletionBasedOnDepDate(keys)

	assert.Equal(t, 1, len(k))

}

func Test_deletionBasedOnDepDateWithoutError(t *testing.T) {

	keys := []string{"AMS-NYC-EK-NDC-2022-02-02-O", "AMS-NYC-EK-NDC-2022-02-03-O", "AMS-NYC-EK-NDC-2022-02-04-O"}
	k, _ := deletionBasedOnDepDate(keys)

	assert.Equal(t, 3, len(k))

}

func Test_checkForKeysDeletionFalse(t *testing.T) {

	y := time.Now()
	x := y.AddDate(0, -3, -3)

	z := time.Duration(6) * time.Minute

	b := checkForValidKeyBasedOnCurrentTime(x, z)

	assert.Equal(t, true, b)

}

func Test_checkForKeysDeletionTrue(t *testing.T) {

	y := time.Now()
	x := y.AddDate(0, 3, 3)

	z := time.Duration(6) * time.Minute

	b := checkForValidKeyBasedOnCurrentTime(x, z)

	assert.Equal(t, false, b)

}

func Test_checkIfKeyHasPastDeptDate(t *testing.T) {
	b := checkIfKeyHasPastDeptDate("AMS-NYC-EK-NDC-2022-02-02-O")

	assert.Equal(t, true, b)
}

func Test_checkIfKeyHasPastDeptDateLen(t *testing.T) {
	b := checkIfKeyHasPastDeptDate("AMS-NYC")

	assert.Equal(t, true, b)
}

func Test_checkIfKeyHasPastDeptDateFalse(t *testing.T) {
	b := checkIfKeyHasPastDeptDate("AMS-NYC-EK-NDC-2022-06-02-O")

	assert.Equal(t, false, b)
}

func Test_checkIfKeyHasExpired(t *testing.T) {

	prop := loadProperties()

	y := time.Now()
	x := y.AddDate(0, -3, -3)
	k := "AMS-NYC-AF-OTH-2022-06-02-O"

	b, err := checkIfKeyIsValidBasedOnConfig(&k, x, prop)

	assert.Equal(t, false, b)
	assert.Equal(t, nil, err)
}

func Test_convertDate(t *testing.T) {

	l := fmt.Sprint("combinations" + "[" + strconv.Itoa(2) + "]" + "additionalParams.isValid= params.valid")
	fmt.Println(l)
	var d time.Time

	fmt.Println(d.IsZero())
	x := "2021-09-05T09:45:35.619Z"
	y, err := convertDate(x)
	fmt.Println(y.Format("020106"))
	fmt.Println(y.Format("1504"))

	z := "2021-10-05T09:45:35.619Z"
	a, _ := convertDate(z)

	duration := a.Sub(y)

	b := int64(math.Ceil(duration.Hours() / 24))

	fmt.Println(b)
	fmt.Println(y)

	v := checkForValidKeyBasedOnCurrentTime(y, 0)
	assert.Equal(t, false, v)
	assert.Equal(t, nil, err)
}

func Test_loadResultFromCache(t *testing.T) {
	str := "{\"routes\":{\"PJ1\":{\"id\":\"PJ1\",\"stops\":0,\"elapsedFlyingTimeMinutes\":480,\"segmentIDs\":[\"SEG1\"]},\"PJ10\":{\"id\":\"PJ10\",\"stops\":1,\"elapsedFlyingTimeMinutes\":695,\"segmentIDs\":[\"SEG12\",\"SEG13\"]},\"PJ11\":{\"id\":\"PJ11\",\"stops\":1,\"elapsedFlyingTimeMinutes\":710,\"segmentIDs\":[\"SEG14\",\"SEG15\"]},\"PJ12\":{\"id\":\"PJ12\",\"stops\":1,\"elapsedFlyingTimeMinutes\":710,\"segmentIDs\":[\"SEG16\",\"SEG17\"]},\"PJ13\":{\"id\":\"PJ13\",\"stops\":1,\"elapsedFlyingTimeMinutes\":660,\"segmentIDs\":[\"SEG18\",\"SEG19\"]},\"PJ14\":{\"id\":\"PJ14\",\"stops\":1,\"elapsedFlyingTimeMinutes\":695,\"segmentIDs\":[\"SEG20\",\"SEG21\"]},\"PJ15\":{\"id\":\"PJ15\",\"stops\":1,\"elapsedFlyingTimeMinutes\":715,\"segmentIDs\":[\"SEG22\",\"SEG23\"]},\"PJ16\":{\"id\":\"PJ16\",\"stops\":1,\"elapsedFlyingTimeMinutes\":715,\"segmentIDs\":[\"SEG22\",\"SEG24\"]},\"PJ17\":{\"id\":\"PJ17\",\"stops\":1,\"elapsedFlyingTimeMinutes\":665,\"segmentIDs\":[\"SEG25\",\"SEG26\"]},\"PJ2\":{\"id\":\"PJ2\",\"stops\":0,\"elapsedFlyingTimeMinutes\":480,\"segmentIDs\":[\"SEG2\"]},\"PJ3\":{\"id\":\"PJ3\",\"stops\":0,\"elapsedFlyingTimeMinutes\":484,\"segmentIDs\":[\"SEG3\"]},\"PJ4\":{\"id\":\"PJ4\",\"stops\":0,\"elapsedFlyingTimeMinutes\":484,\"segmentIDs\":[\"SEG4\"]},\"PJ5\":{\"id\":\"PJ5\",\"stops\":0,\"elapsedFlyingTimeMinutes\":484,\"segmentIDs\":[\"SEG5\"]},\"PJ6\":{\"id\":\"PJ6\",\"stops\":0,\"elapsedFlyingTimeMinutes\":485,\"segmentIDs\":[\"SEG6\"]},\"PJ7\":{\"id\":\"PJ7\",\"stops\":0,\"elapsedFlyingTimeMinutes\":501,\"segmentIDs\":[\"SEG7\"]},\"PJ8\":{\"id\":\"PJ8\",\"stops\":1,\"elapsedFlyingTimeMinutes\":694,\"segmentIDs\":[\"SEG8\",\"SEG9\"]},\"PJ9\":{\"id\":\"PJ9\",\"stops\":1,\"elapsedFlyingTimeMinutes\":680,\"segmentIDs\":[\"SEG10\",\"SEG11\"]}},\"segments\":{\"SEG1\":{\"id\":\"SEG1\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T13:25:00\",\"arrivalTime\":\"2021-10-21T15:25:00\",\"flightNumber\":\"0154\",\"airplaneType\":\"781\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG10\":{\"id\":\"SEG10\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"CDG\",\"destinationTerminal\":\"2F\",\"departureTime\":\"2021-10-21T16:30:00\",\"arrivalTime\":\"2021-10-21T17:45:00\",\"flightNumber\":\"1243\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG11\":{\"id\":\"SEG11\",\"origin\":\"CDG\",\"originTerminal\":\"2E\",\"destination\":\"JFK\",\"destinationTerminal\":\"1\",\"departureTime\":\"2021-10-21T19:20:00\",\"arrivalTime\":\"2021-10-21T21:50:00\",\"flightNumber\":\"2307\",\"airplaneType\":\"772\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"AF\"},\"SEG12\":{\"id\":\"SEG12\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"CDG\",\"destinationTerminal\":\"2F\",\"departureTime\":\"2021-10-21T07:15:00\",\"arrivalTime\":\"2021-10-21T08:40:00\",\"flightNumber\":\"1227\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG13\":{\"id\":\"SEG13\",\"origin\":\"CDG\",\"originTerminal\":\"2E\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T10:20:00\",\"arrivalTime\":\"2021-10-21T12:50:00\",\"flightNumber\":\"6184\",\"airplaneType\":\"333\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"DL\"},\"SEG14\":{\"id\":\"SEG14\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"CDG\",\"destinationTerminal\":\"2F\",\"departureTime\":\"2021-10-21T08:00:00\",\"arrivalTime\":\"2021-10-21T09:25:00\",\"flightNumber\":\"1229\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG15\":{\"id\":\"SEG15\",\"origin\":\"CDG\",\"originTerminal\":\"2E\",\"destination\":\"JFK\",\"destinationTerminal\":\"1\",\"departureTime\":\"2021-10-21T11:20:00\",\"arrivalTime\":\"2021-10-21T13:50:00\",\"flightNumber\":\"2425\",\"airplaneType\":\"77W\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"AF\"},\"SEG16\":{\"id\":\"SEG16\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"CDG\",\"destinationTerminal\":\"2F\",\"departureTime\":\"2021-10-21T12:25:00\",\"arrivalTime\":\"2021-10-21T13:40:00\",\"flightNumber\":\"1233\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG17\":{\"id\":\"SEG17\",\"origin\":\"CDG\",\"originTerminal\":\"2E\",\"destination\":\"JFK\",\"destinationTerminal\":\"1\",\"departureTime\":\"2021-10-21T15:45:00\",\"arrivalTime\":\"2021-10-21T18:15:00\",\"flightNumber\":\"2304\",\"airplaneType\":\"77W\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"AF\"},\"SEG18\":{\"id\":\"SEG18\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"LHR\",\"destinationTerminal\":\"2\",\"departureTime\":\"2021-10-21T08:40:00\",\"arrivalTime\":\"2021-10-21T09:00:00\",\"flightNumber\":\"1007\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG19\":{\"id\":\"SEG19\",\"origin\":\"LHR\",\"originTerminal\":\"3\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T11:00:00\",\"arrivalTime\":\"2021-10-21T13:40:00\",\"flightNumber\":\"4820\",\"airplaneType\":\"351\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"VS\"},\"SEG2\":{\"id\":\"SEG2\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T13:25:00\",\"arrivalTime\":\"2021-10-21T15:25:00\",\"flightNumber\":\"0071\",\"airplaneType\":\"789\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG20\":{\"id\":\"SEG20\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"LHR\",\"destinationTerminal\":\"2\",\"departureTime\":\"2021-10-21T15:55:00\",\"arrivalTime\":\"2021-10-21T16:15:00\",\"flightNumber\":\"1021\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG21\":{\"id\":\"SEG21\",\"origin\":\"LHR\",\"originTerminal\":\"3\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T18:50:00\",\"arrivalTime\":\"2021-10-21T21:30:00\",\"flightNumber\":\"4824\",\"airplaneType\":\"351\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"VS\"},\"SEG22\":{\"id\":\"SEG22\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"LHR\",\"destinationTerminal\":\"2\",\"departureTime\":\"2021-10-21T10:15:00\",\"arrivalTime\":\"2021-10-21T10:45:00\",\"flightNumber\":\"1009\",\"airplaneType\":\"73H\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG23\":{\"id\":\"SEG23\",\"origin\":\"LHR\",\"originTerminal\":\"3\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T13:30:00\",\"arrivalTime\":\"2021-10-21T16:10:00\",\"flightNumber\":\"2502\",\"airplaneType\":\"789\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"VS\"},\"SEG24\":{\"id\":\"SEG24\",\"origin\":\"LHR\",\"originTerminal\":\"3\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T13:30:00\",\"arrivalTime\":\"2021-10-21T16:10:00\",\"flightNumber\":\"2503\",\"airplaneType\":\"789\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"VS\"},\"SEG25\":{\"id\":\"SEG25\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"FRA\",\"destinationTerminal\":\"2\",\"departureTime\":\"2021-10-21T08:25:00\",\"arrivalTime\":\"2021-10-21T09:35:00\",\"flightNumber\":\"1763\",\"airplaneType\":\"E75\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"WA\"},\"SEG26\":{\"id\":\"SEG26\",\"origin\":\"FRA\",\"originTerminal\":\"2\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T10:45:00\",\"arrivalTime\":\"2021-10-21T13:30:00\",\"flightNumber\":\"6107\",\"airplaneType\":\"764\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"DL\"},\"SEG3\":{\"id\":\"SEG3\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T17:55:00\",\"arrivalTime\":\"2021-10-21T19:59:00\",\"flightNumber\":\"0063\",\"airplaneType\":\"772\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG4\":{\"id\":\"SEG4\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T17:55:00\",\"arrivalTime\":\"2021-10-21T19:59:00\",\"flightNumber\":\"0643\",\"airplaneType\":\"789\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG5\":{\"id\":\"SEG5\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T17:55:00\",\"arrivalTime\":\"2021-10-21T19:59:00\",\"flightNumber\":\"0075\",\"airplaneType\":\"781\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG6\":{\"id\":\"SEG6\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T13:20:00\",\"arrivalTime\":\"2021-10-21T15:25:00\",\"flightNumber\":\"0641\",\"airplaneType\":\"332\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG7\":{\"id\":\"SEG7\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T10:35:00\",\"arrivalTime\":\"2021-10-21T12:56:00\",\"flightNumber\":\"6020\",\"airplaneType\":\"339\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"DL\"},\"SEG8\":{\"id\":\"SEG8\",\"origin\":\"AMS\",\"originTerminal\":\"\",\"destination\":\"BOS\",\"destinationTerminal\":\"\",\"departureTime\":\"2021-10-21T10:20:00\",\"arrivalTime\":\"2021-10-21T12:10:00\",\"flightNumber\":\"0073\",\"airplaneType\":\"781\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"KL\"},\"SEG9\":{\"id\":\"SEG9\",\"origin\":\"BOS\",\"originTerminal\":\"A\",\"destination\":\"JFK\",\"destinationTerminal\":\"4\",\"departureTime\":\"2021-10-21T14:25:00\",\"arrivalTime\":\"2021-10-21T15:54:00\",\"flightNumber\":\"5103\",\"airplaneType\":\"E75\",\"marketingCarrier\":\"KL\",\"operatingCarrier\":\"YX\"}},\"combinations\":[{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG1\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ1\"],\"tariffType\":\"PU\",\"additionalParams\":{\"c859097b-3836-44ea-9909-7b383634eab3\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0001\",\"offerItemIds\":\"c859097b-3836-44ea-9909-7b383634eab3\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG2\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ2\"],\"tariffType\":\"PU\",\"additionalParams\":{\"c587aa2b-2b02-4162-87aa-2b2b02f162cb\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0002\",\"offerItemIds\":\"c587aa2b-2b02-4162-87aa-2b2b02f162cb\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG3\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ3\"],\"tariffType\":\"PU\",\"additionalParams\":{\"a464aa9c-0c60-4c86-a4aa-9c0c603c86e4\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0003\",\"offerItemIds\":\"a464aa9c-0c60-4c86-a4aa-9c0c603c86e4\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG4\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ4\"],\"tariffType\":\"PU\",\"additionalParams\":{\"ed7cd1d8-c7ff-4c3d-bcd1-d8c7fffc3d2b\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0004\",\"offerItemIds\":\"ed7cd1d8-c7ff-4c3d-bcd1-d8c7fffc3d2b\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG5\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ5\"],\"tariffType\":\"PU\",\"additionalParams\":{\"d24b09eb-8b01-4fd5-8b09-eb8b01cfd5a0\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0005\",\"offerItemIds\":\"d24b09eb-8b01-4fd5-8b09-eb8b01cfd5a0\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG6\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ6\"],\"tariffType\":\"PU\",\"additionalParams\":{\"ced59873-026f-4425-9598-73026fb4254b\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0006\",\"offerItemIds\":\"ced59873-026f-4425-9598-73026fb4254b\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1983.42,\"totalTaxAmount\":187.42,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1983.42,\"taxAmount\":187.42,\"fareProducts\":[{\"segmentID\":\"SEG7\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ7\"],\"tariffType\":\"PU\",\"additionalParams\":{\"b6afe7ba-03c3-428d-afe7-ba03c3a28d37\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0007\",\"offerItemIds\":\"b6afe7ba-03c3-428d-afe7-ba03c3a28d37\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1988.14,\"totalTaxAmount\":192.14,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1988.14,\"taxAmount\":192.14,\"fareProducts\":[{\"segmentID\":\"SEG8\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG9\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ8\"],\"tariffType\":\"PU\",\"additionalParams\":{\"c986bd0d-2732-4b76-86bd-0d2732ab7687\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0008\",\"offerItemIds\":\"c986bd0d-2732-4b76-86bd-0d2732ab7687\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1988.95,\"totalTaxAmount\":192.95,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1988.95,\"taxAmount\":192.95,\"fareProducts\":[{\"segmentID\":\"SEG10\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG11\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ9\"],\"tariffType\":\"PU\",\"additionalParams\":{\"d6cef17b-6804-40b6-8ef1-7b6804c0b61f\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0009\",\"offerItemIds\":\"d6cef17b-6804-40b6-8ef1-7b6804c0b61f\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1988.95,\"totalTaxAmount\":192.95,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1988.95,\"taxAmount\":192.95,\"fareProducts\":[{\"segmentID\":\"SEG12\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG13\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ10\"],\"tariffType\":\"PU\",\"additionalParams\":{\"ce31d6bb-ac49-4a8f-b1d6-bbac498a8f69\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000a\",\"offerItemIds\":\"ce31d6bb-ac49-4a8f-b1d6-bbac498a8f69\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1988.95,\"totalTaxAmount\":192.95,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1988.95,\"taxAmount\":192.95,\"fareProducts\":[{\"segmentID\":\"SEG14\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG15\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ11\"],\"tariffType\":\"PU\",\"additionalParams\":{\"c6000399-8eb4-4f3e-8003-998eb40f3e34\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000b\",\"offerItemIds\":\"c6000399-8eb4-4f3e-8003-998eb40f3e34\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":1988.95,\"totalTaxAmount\":192.95,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":1988.95,\"taxAmount\":192.95,\"fareProducts\":[{\"segmentID\":\"SEG16\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG17\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ12\"],\"tariffType\":\"PU\",\"additionalParams\":{\"e54f27ca-b5e2-4bf7-8f27-cab5e20bf713\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000c\",\"offerItemIds\":\"e54f27ca-b5e2-4bf7-8f27-cab5e20bf713\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":2009.56,\"totalTaxAmount\":213.56,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":2009.56,\"taxAmount\":213.56,\"fareProducts\":[{\"segmentID\":\"SEG18\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG19\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ13\"],\"tariffType\":\"PU\",\"additionalParams\":{\"a1f1bb8b-806c-417a-b1bb-8b806ca17ab2\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000d\",\"offerItemIds\":\"a1f1bb8b-806c-417a-b1bb-8b806ca17ab2\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":2009.56,\"totalTaxAmount\":213.56,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":2009.56,\"taxAmount\":213.56,\"fareProducts\":[{\"segmentID\":\"SEG20\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG21\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ14\"],\"tariffType\":\"PU\",\"additionalParams\":{\"e1ed8d19-db42-4ce3-ad8d-19db42fce38b\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000e\",\"offerItemIds\":\"e1ed8d19-db42-4ce3-ad8d-19db42fce38b\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":2009.56,\"totalTaxAmount\":213.56,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":2009.56,\"taxAmount\":213.56,\"fareProducts\":[{\"segmentID\":\"SEG22\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG23\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ15\"],\"tariffType\":\"PU\",\"additionalParams\":{\"d9e3aba6-2e91-48c0-a3ab-a62e9128c01b\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d000f\",\"offerItemIds\":\"d9e3aba6-2e91-48c0-a3ab-a62e9128c01b\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":2009.56,\"totalTaxAmount\":213.56,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":2009.56,\"taxAmount\":213.56,\"fareProducts\":[{\"segmentID\":\"SEG22\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG24\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ16\"],\"tariffType\":\"PU\",\"additionalParams\":{\"e6815576-f5d4-479b-8155-76f5d4c79b28\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0010\",\"offerItemIds\":\"e6815576-f5d4-479b-8155-76f5d4c79b28\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}},{\"totalFareAmount\":2015.2,\"totalTaxAmount\":219.2,\"fares\":[{\"paxId\":\"adt1\",\"paxType\":\"ADT\",\"fareAmount\":2015.2,\"taxAmount\":219.2,\"fareProducts\":[{\"segmentID\":\"SEG25\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]},{\"segmentID\":\"SEG26\",\"cabinProduct\":\"ECONOMY\",\"fareBase\":\"BS00BENB\",\"ancillaryIDs\":[\"BA1_BAGGAGE\",\"HAND\"]}],\"vcc\":\"KL\"}],\"routeIDs\":[\"PJ17\"],\"tariffType\":\"PU\",\"additionalParams\":{\"b85c97d2-10c6-401f-9c97-d210c6601f66\":\"PAX1\",\"isValid\":\"false\",\"offerId\":\"c6620ec8-6af0-4def-a20e-c86af03d0011\",\"offerItemIds\":\"b85c97d2-10c6-401f-9c97-d210c6601f66\",\"offerValidity\":\"2021-08-05T09:45:35.619Z\"}}],\"ancillaries\":[{\"id\":\"BA1_BAGGAGE\",\"type\":\"BAGGAGE\",\"additionalParams\":{\"pieces\":\"1\",\"type\":\"NORMAL\"}},{\"id\":\"HAND\",\"type\":\"BAGGAGE\",\"additionalParams\":{\"pieces\":\"1\",\"type\":\"HAND\"}}],\"additionalParams\":{\"correlationId\":\"NDC-TFM-SONATA20210805091532118099\"},\"timestamp\":\"0001-01-01T00:00:00Z\"}"
	res, _ := loadResultFromCache(str)

	//fmt.Println(res)
	fmt.Println(&res)
}

//insert, update, delete

func TestMainCall(t *testing.T) {
	var segIds []string

	var flightRef = make(map[string]int)

	flightRef["CHD"] = 1
	flightRef["CHD"] = 1

	fmt.Println(flightRef)

	segIds = append(segIds, "ADT")

	fmt.Println(len(segIds))
}
